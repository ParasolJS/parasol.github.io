{"version":3,"file":"parasol.esm.js","sources":["../src/api/init.js","../src/util/as_float.js","../src/api/attachGrid.js","../src/api/gridUpdate.js","../src/api/sync.js","../src/api/linked.js","../src/util/wrangle.js","../src/util/arr_stats.js","../src/util/standardize.js","../src/util/format_data.js","../src/util/add_column.js","../src/api/cluster.js","../src/util/normalize.js","../src/api/weightedSums.js","../src/api/hideAxes.js","../src/api/showAxes.js","../src/api/setAxesLayout.js","../src/api/keepData.js","../src/api/removeData.js","../node_modules/file-saver/FileSaver.js","../src/api/exportData.js","../src/api/resetSelections.js","../src/wrap/alpha.js","../src/wrap/color.js","../src/wrap/alphaOnBrushed.js","../src/wrap/brushedColor.js","../src/wrap/reorderable.js","../src/wrap/composite.js","../src/wrap/shadows.js","../src/wrap/dimensions.js","../src/wrap/flipAxes.js","../src/wrap/scale.js","../src/wrap/bundleDimension.js","../src/wrap/bundlingStrength.js","../src/wrap/smoothness.js","../src/wrap/render.js","../src/wrap/brushReset.js","../src/wrap/unmark.js","../src/wrap/unhighlight.js","../src/state/defaultConfig.js","../src/state/initState.js","../src/index.js"],"sourcesContent":["import { selectAll } from 'd3';\r\nimport ParCoords from 'parcoord-es';\r\n\r\n/**\r\n * Setup a new visualization.\r\n *\r\n * @param config\r\n * @returns {ps} a parasol closure\r\n */\r\nconst init = config => {\r\n  /**\r\n   * Create a visualization within a container. The selector can also be a d3 selection.\r\n   *\r\n   * @param selection a d3 selection\r\n   * @returns {ps} instance for chained api, compatible with parcoords api\r\n   */\r\n  const ps = function(selection) {\r\n    selection = ps.selection = selectAll(selection);\r\n\r\n    // store pc charts in array\r\n    ps.charts = [];\r\n    selection.each(function(d, i) {\r\n      ps.charts[i] = ParCoords(config.chartOptions)(this)\r\n        .data(config.data)\r\n        .hideAxis(['id'])\r\n        .alpha(0.4)\r\n        .render()\r\n        .mode('queue')\r\n        .brushMode('1D-axes'); //1D-axes must be used with linking\r\n\r\n      // add \"id\" to partition globally\r\n      config.partition[i] = ['id'];\r\n    });\r\n\r\n    // for chained api\r\n    return ps;\r\n  };\r\n  // for partial-application style programming\r\n  return ps;\r\n};\r\n\r\nexport default init;\r\n","const as_float = x => {\r\n  const converted = parseFloat(x);\r\n  return isNaN(converted) ? x : converted;\r\n};\r\n\r\nexport default as_float;\r\n","import SlickGrid from 'slickgrid-es6';\r\nimport { difference } from 'lodash-es';\r\n\r\nimport as_float from '../util/as_float';\r\n\r\n/**\r\n * Creates a new instance of the grid.\r\n * @class SlickGrid\r\n * @constructor\r\n * @param {string} container:   DOM element in which grid will be placed.\r\n * @param {array}  columns:    An array of column definitions (objects).\r\n * @param {object} options:     SlickGrid options.\r\n **/\r\nconst attachGrid = (config, ps, flags) =>\r\n  function({ container, columns = null, options = null }) {\r\n    flags.grid = true;\r\n\r\n    const checkboxSelector = new SlickGrid.Plugins.CheckboxSelectColumn({\r\n      cssClass: 'slick-cell-checkboxsel',\r\n    });\r\n\r\n    if (columns === null) {\r\n      // place id col on left\r\n      let column_keys = config.vars;\r\n      column_keys = difference(column_keys, ['id']);\r\n      // NOTE: remove line below to remove id col from grid\r\n      column_keys.unshift('id');\r\n\r\n      columns = column_keys.map((key, i) => ({\r\n        id: key,\r\n        name: key,\r\n        field: key,\r\n        sortable: true,\r\n      }));\r\n      columns.unshift(checkboxSelector.getColumnDefinition());\r\n    }\r\n\r\n    if (options === null) {\r\n      options = {\r\n        enableCellNavigation: true,\r\n        enableColumnReorder: true,\r\n        multiColumnSort: false,\r\n        editable: true,\r\n        asyncEditorLoading: false,\r\n        autoEdit: false,\r\n      };\r\n    }\r\n\r\n    // initialize\r\n    config.dataView = new SlickGrid.Data.DataView();\r\n    config.dataView.setItems(config.data);\r\n    config.grid = new SlickGrid.Grid(\r\n      container,\r\n      config.dataView,\r\n      columns,\r\n      options\r\n    );\r\n\r\n    config.grid.setSelectionModel(\r\n      new SlickGrid.Plugins.RowSelectionModel({ selectActiveRow: false })\r\n    );\r\n    config.grid.registerPlugin(checkboxSelector);\r\n\r\n    // wire up model events to drive the grid\r\n    config.dataView.onRowCountChanged.subscribe((e, args) => {\r\n      config.grid.updateRowCount();\r\n      config.grid.render();\r\n    });\r\n\r\n    config.dataView.onRowsChanged.subscribe((e, args) => {\r\n      config.grid.invalidateRows(args.rows);\r\n      config.grid.render();\r\n    });\r\n\r\n    // keep checkboxes matched with row on update\r\n    config.dataView.syncGridSelection(config.grid);\r\n\r\n    // column sorting\r\n    let sortcol = columns.map(c => c.name);\r\n    sortcol.shift();\r\n    let sortdir = 1;\r\n\r\n    const comparer = (a, b) => {\r\n      const x = as_float(a[sortcol]);\r\n      const y = as_float(b[sortcol]);\r\n      return x == y ? 0 : x > y ? 1 : -1;\r\n    };\r\n\r\n    // click header to sort grid column\r\n    config.grid.onSort.subscribe((e, args) => {\r\n      sortdir = args.sortAsc ? 1 : -1;\r\n      sortcol = args.sortCol.field;\r\n\r\n      config.dataView.sort(comparer, args.sortAsc);\r\n    });\r\n\r\n    return this;\r\n  };\r\n\r\nexport default attachGrid;\r\n","import { union } from 'lodash-es';\r\nimport as_float from '../util/as_float';\r\n\r\n/**\r\n * Update data displayed in grid.\r\n * @param {array}  data:    array of objects.\r\n * @param {array} columns:  column definitions.\r\n **/\r\nconst gridUpdate = (config, ps, flags) =>\r\n  function({ data = null, columns = null } = {}) {\r\n    if (columns !== null) {\r\n      config.grid.setColumns(columns);\r\n      config.grid.render();\r\n    }\r\n    if (data === null) {\r\n      data = config.selections();\r\n      if (data.length === 0) {\r\n        // if selections empty, use full dataset\r\n        data = config.data;\r\n      }\r\n    }\r\n    // if marked data exists, keep in grid\r\n    if (config.marked.length) {\r\n      data = union(data, config.marked);\r\n    }\r\n\r\n    const comparer = (a, b) => {\r\n      const x = as_float(a['id']);\r\n      const y = as_float(b['id']);\r\n      return x == y ? 0 : x > y ? 1 : -1;\r\n    };\r\n\r\n    config.dataView.beginUpdate();\r\n    config.dataView.setItems(data);\r\n    config.dataView.sort(comparer, true);\r\n    config.dataView.endUpdate();\r\n\r\n    return this;\r\n  };\r\n\r\nexport default gridUpdate;\r\n","import { union, intersection } from 'lodash-es';\r\n\r\n// synchronize data between linked components\r\nconst sync = (config, ps, flags) =>\r\n  function() {\r\n    //obtain array of brushed data for each chart\r\n    const brush_extents = [];\r\n    ps.linked.forEach(pc => {\r\n      brush_extents.push(pc.selected());\r\n    });\r\n\r\n    //check edge case where all brushes individually clicked away\r\n    if (union(...brush_extents).length == 0) {\r\n      ps.linked.forEach(pc => {\r\n        pc.brushReset();\r\n      });\r\n      config.brushed = [];\r\n      // update data in grid\r\n      if (flags.grid) {\r\n        ps.gridUpdate(config.data);\r\n      }\r\n    } else {\r\n      const brushed = intersection(...brush_extents);\r\n      ps.linked.forEach(pc => {\r\n        pc.brushed(brushed).render();\r\n      });\r\n\r\n      // NOTE: once pc.selected issue fixed, remove if statement and uncomment line below\r\n      //config.brushed = brushed;\r\n      if (brushed.length < config.data.length) {\r\n        config.brushed = brushed;\r\n      } else {\r\n        config.brushed = [];\r\n      }\r\n      // update data in grid\r\n      // NOTE: once pc.selected fixed, remove arg from gridUpdate\r\n      if (flags.grid) {\r\n        ps.gridUpdate({ data: brushed });\r\n      }\r\n    }\r\n  };\r\n\r\nexport default sync;\r\n","import sync from './sync';\r\n\r\n/**\r\n * Link brush activity between specified charts, and grid if it exists.\r\n *\r\n * @param {array} chartIDs:   charts to be linked (defaults to all).\r\n **/\r\nconst linked = (config, ps, flags) =>\r\n  function(chartIDs = [...Array(ps.charts.length).keys()]) {\r\n    // force numeric type for indexing\r\n    chartIDs = chartIDs.map(Number);\r\n\r\n    // setup linked components\r\n    ps.linked = [];\r\n    chartIDs.forEach((i, j) => {\r\n      ps.linked[j] = ps.charts[i];\r\n    });\r\n\r\n    ps.linked.forEach(pc => {\r\n      pc.on('brush', sync(config, ps, flags));\r\n    });\r\n\r\n    // connect grid\r\n    if (flags.grid) {\r\n      // highlight row in chart\r\n      config.grid.onMouseEnter.subscribe((e, args) => {\r\n        let i = config.grid.getCellFromEvent(e).row;\r\n        const d = config.dataView.getItems() || config.data;\r\n        ps.linked.forEach(pc => {\r\n          pc.highlight([d[i]]);\r\n        });\r\n      });\r\n      config.grid.onMouseLeave.subscribe((e, args) => {\r\n        ps.linked.forEach(pc => {\r\n          pc.unhighlight();\r\n        });\r\n      });\r\n\r\n      // mark row in chart\r\n      config.grid.onSelectedRowsChanged.subscribe((e, args) => {\r\n        // reset and update selected rows\r\n        const selected_row_ids = config.grid.getSelectedRows();\r\n        const d = config.dataView.getItems() || config.data;\r\n        ps.linked.forEach(pc => {\r\n          pc.unmark();\r\n        });\r\n        selected_row_ids.forEach(i => {\r\n          ps.linked.forEach(pc => {\r\n            pc.mark([d[i]]);\r\n          });\r\n        });\r\n\r\n        // update marked data\r\n        config.marked = ps.linked[0].marked();\r\n\r\n        // refresh grid if brushes are applied\r\n        if (config.brushed.length) {\r\n          ps.gridUpdate();\r\n        }\r\n      });\r\n    }\r\n\r\n    return this;\r\n  };\r\n\r\nexport default linked;\r\n","// wrangling tools to manipulate data for processing values\r\n\r\n// d3 data is formatted as array of objects, each row is an object\r\n// convert to object of arrays, each array is a column\r\n// e.g. {\"var1\": [col1], \"var2\": [col2]}\r\nconst array_to_object = data =>\r\n  data.reduce((acc, obj) => {\r\n    Object.keys(obj).forEach(function(k) {\r\n      acc[k] = (acc[k] || []).concat(Number(obj[k]));\r\n    });\r\n    return acc;\r\n  }, {});\r\n\r\n// data is formatted as 'data frame' with columns as keys\r\n// convert back to array of objects with rows as objects\r\nconst object_to_array = (df, data) => {\r\n  var result = [];\r\n  Object.entries(df).forEach(([key, values]) => {\r\n    values.forEach((val, i) => {\r\n      result[i] = result[i] || {};\r\n      // get original string if value is NaN\r\n      if (isNaN(val)) {\r\n        result[i][key] = data[i][key];\r\n      } else {\r\n        result[i][key] = val.toString();\r\n      }\r\n    });\r\n  });\r\n  return result;\r\n};\r\n\r\nexport { array_to_object, object_to_array };\r\n","// inspired by: https://gist.github.com/Daniel-Hug/7273430\r\nconst arr = {\r\n  max: function(array) {\r\n    return Math.max.apply(null, array);\r\n  },\r\n\r\n  min: function(array) {\r\n    return Math.min.apply(null, array);\r\n  },\r\n\r\n  range: function(array) {\r\n    return arr.max(array) - arr.min(array);\r\n  },\r\n\r\n  extents: function(array) {\r\n    return [arr.min(array), arr.max(array)];\r\n  },\r\n\r\n  sum: function(array) {\r\n    let num = 0;\r\n    for (let i = 0, l = array.length; i < l; i++) num += array[i];\r\n    return num;\r\n  },\r\n\r\n  mean: function(array) {\r\n    return arr.sum(array) / array.length;\r\n  },\r\n\r\n  variance: function(array) {\r\n    const mean = arr.mean(array);\r\n    return arr.mean(\r\n      array.map(function(num) {\r\n        return Math.pow(num - mean, 2);\r\n      })\r\n    );\r\n  },\r\n\r\n  standardDeviation: function(array) {\r\n    return Math.sqrt(arr.variance(array));\r\n  },\r\n\r\n  zScores: function(array) {\r\n    const mean = arr.mean(array);\r\n    const standardDeviation = arr.standardDeviation(array);\r\n    return array.map(function(num) {\r\n      return (num - mean) / standardDeviation;\r\n    });\r\n  },\r\n\r\n  norms: function(array) {\r\n    const extents = arr.extents(array);\r\n    return array.map(function(num) {\r\n      return (num - extents[0]) / (extents[1] - extents[0]);\r\n    });\r\n  },\r\n};\r\n\r\nexport default arr;\r\n","import { array_to_object, object_to_array } from './wrangle';\r\nimport arr from './arr_stats';\r\n\r\n// convert values to zscores\r\nconst standardize = data => {\r\n  // reformat data\r\n  const df = array_to_object(data);\r\n\r\n  // standardize values\r\n  Object.keys(df).forEach(key => {\r\n    df[key] = arr.zScores(df[key]);\r\n  });\r\n\r\n  // convert back to original data type\r\n  return object_to_array(df, data);\r\n};\r\n\r\nexport default standardize;\r\n","// format data values as strings\r\n// const parcoords_format = d => {\r\n// \td.forEach(\r\n// \t\t(d_obj) => {\r\n// \t\t\tObject.entries(d_obj).forEach(\r\n// \t\t\t\t([key, value]) =>  {\r\n// \t\t\t\t\td_obj[key] = value.toString();\r\n// \t\t\t\t});\r\n// \t\t});\r\n// };\r\nimport { csvFormat, csvParse } from 'd3-dsv';\r\n\r\nconst format_data = data => csvParse(csvFormat(data));\r\n\r\nexport default format_data;\r\n","import { includes } from 'lodash-es';\r\n// add column defintion to grid columns\r\nconst add_column = (columns, col_name) => {\r\n  // ignore repeats\r\n  const names = columns.map(col => col.name);\r\n  if (includes(names, col_name)) {\r\n    return columns;\r\n  } else {\r\n    const col_def = {\r\n      id: col_name,\r\n      name: col_name,\r\n      field: col_name,\r\n      sortable: true,\r\n    };\r\n    columns.push(col_def);\r\n    return columns;\r\n  }\r\n};\r\nexport default add_column;\r\n","import kmeans from 'ml-kmeans';\r\nimport { scaleOrdinal, schemeCategory10 } from 'd3';\r\n\r\nimport standardize from '../util/standardize';\r\nimport format_data from '../util/format_data';\r\nimport add_column from '../util/add_column';\r\n\r\n/**\r\n * Partition data into k clusters in which each data element belongs to\r\n * the cluster with the nearest mean.\r\n *\r\n * @param {int} k: number of clusters\r\n * @param {array} displayIDs: charts that will display cluster colors\r\n * @param {} palette: d3 palette or function mapping cluster ids to color\r\n * @param {array} vars: variables used for clustering. NOTE: associated data must be numeric\r\n * @param {object} options: ml-kmeans options\r\n * @param {bool} std: convert values to zscores to obtain unbiased clusters\r\n * @param {bool} hidden: determines whether cluster axis will be displayed on charts (can be individually updated with hideAxis later)\r\n */\r\nconst cluster = (config, ps, flags) =>\r\n  function({\r\n    k = 3,\r\n    vars = config.vars,\r\n    displayIDs = [...Array(ps.charts.length).keys()],\r\n    palette = schemeCategory10,\r\n    options = {},\r\n    std = true,\r\n    hidden = true,\r\n  } = {}) {\r\n    if (Array.isArray(palette)) {\r\n      const scheme = scaleOrdinal(palette);\r\n      palette = d => scheme(Number(d['cluster']));\r\n    } else {\r\n      palette = palette;\r\n    }\r\n\r\n    let data = [];\r\n    if (std === true) {\r\n      data = standardize(config.data);\r\n    } else {\r\n      data = config.data;\r\n    }\r\n\r\n    // setup object to filter variables that will be used in clustering\r\n    const cluster_vars = {};\r\n    vars.forEach(v => {\r\n      cluster_vars[v] = true;\r\n    });\r\n\r\n    // get data values in array of arrays for clustering\r\n    // (values from each row object captured in array)\r\n    const values = [];\r\n    data.forEach(d => {\r\n      const target = [];\r\n      Object.entries(d).forEach(([key, value]) => {\r\n        // only take values from variables listed in function argument\r\n        if (cluster_vars[key] == true) {\r\n          target.push(Number(value));\r\n        }\r\n      });\r\n      values.push(target);\r\n    });\r\n\r\n    // preform clustering and update config data\r\n    const result = kmeans(values, k, options);\r\n    config.data.forEach((d, i) => {\r\n      d.cluster = result.clusters[i].toString();\r\n    });\r\n    // console.log('kmeans++');\r\n    // console.log(result.iterations, result.centroids.map(c => c.error));\r\n    // console.log(result.centroids);\r\n\r\n    // hide cluster axis and show colors by default\r\n    if (hidden == true) {\r\n      Object.keys(config.partition).forEach(id => {\r\n        config.partition[id].push('cluster');\r\n      });\r\n    }\r\n\r\n    // format data, update charts\r\n    config.vars.push('cluster');\r\n    config.data = format_data(config.data);\r\n    ps.charts.forEach(pc => {\r\n      pc.data(config.data)\r\n        .render()\r\n        .createAxes();\r\n      // .updateAxes();\r\n    });\r\n\r\n    ps.charts.forEach((pc, i) => {\r\n      // only color charts in displayIDs\r\n      if (displayIDs.includes(i)) {\r\n        pc.color(palette);\r\n      }\r\n      pc.hideAxis(config.partition[i])\r\n        .render()\r\n        .updateAxes(0);\r\n    });\r\n\r\n    if (flags.grid) {\r\n      // add column\r\n      const cols = add_column(config.grid.getColumns(), 'cluster');\r\n      ps.gridUpdate({ columns: cols });\r\n    }\r\n\r\n    return this;\r\n  };\r\n\r\nexport default cluster;\r\n","import { array_to_object, object_to_array } from './wrangle';\r\nimport arr from './arr_stats';\r\n\r\n// normalize data values (scale: 0-1) for unbiased aggregate scores\r\nconst normalize = data => {\r\n  // reformat data\r\n  const df = array_to_object(data);\r\n\r\n  // normalize values\r\n  Object.entries(df).forEach(([key, col]) => {\r\n    df[key] = arr.norms(col);\r\n  });\r\n\r\n  // convert back to original data type\r\n  return object_to_array(df, data);\r\n};\r\n\r\nexport default normalize;\r\n","import normalize from '../util/normalize';\r\nimport format_data from '../util/format_data';\r\nimport arr from '../util/arr_stats';\r\nimport add_column from '../util/add_column';\r\n\r\n/**\r\n * Compute individual weighted sums for each solution based on\r\n * user specified weights.\r\n *\r\n * @param {object} weights: specify weight of each variable, unspecified variables will be assigned weight 0\r\n * @param {array} displayIDs: charts that will display 'weighted sum' variable; defaults to all charts\r\n * @param {bool} norm: normalize values (0-1) to obtain fair weighting\r\n */\r\nconst weightedSums = (config, ps, flags) =>\r\n  function({\r\n    weights,\r\n    displayIDs = [...Array(ps.charts.length).keys()],\r\n    norm = true,\r\n  }) {\r\n    // NOTE: if data is re-scored, old score will not affect new score unless it is given a weight itself in the 'weights' object\r\n\r\n    // force numeric type for indexing\r\n    displayIDs = displayIDs.map(Number);\r\n\r\n    let data = [];\r\n    if (norm === true) {\r\n      data = normalize(config.data);\r\n    } else {\r\n      data = config.data;\r\n    }\r\n\r\n    // compute initial weight for each data element\r\n    const row_totals = [];\r\n    data.forEach((d, i) => {\r\n      let d_weight = 0;\r\n      Object.entries(d).forEach(\r\n        // find cumulative sum of weight times value\r\n        ([key, val]) => {\r\n          if (weights[key]) {\r\n            d_weight += val * weights[key];\r\n          }\r\n        }\r\n      );\r\n      data[i].score = d_weight;\r\n      row_totals.push(d_weight);\r\n    });\r\n\r\n    // normalize all values against total weight and assign values\r\n    const extents = arr.extents(row_totals);\r\n    data.forEach((d, i) => {\r\n      config.data[i]['weighted sum'] = (\r\n        (d.score - extents[0]) /\r\n        (extents[1] - extents[0])\r\n      ).toString();\r\n    });\r\n\r\n    // partition scores var on charts\r\n    Object.keys(config.partition).forEach(i => {\r\n      if (!displayIDs.includes(Number(i))) {\r\n        // chart not in displayIDs, hidden on this chart\r\n        config.partition[Number(i)].push('weighted sum');\r\n      }\r\n    });\r\n\r\n    // weighted sums are ready, update data and charts\r\n    config.vars.push('weighted sum');\r\n    console.log(config.vars);\r\n    config.data = format_data(config.data);\r\n    ps.charts.forEach((pc, i) => {\r\n      pc.data(config.data)\r\n        .hideAxis(config.partition[i])\r\n        .render()\r\n        .createAxes();\r\n      // .updateAxes();\r\n    });\r\n    // NOTE: need to maintain current state of charts somehow\r\n\r\n    if (flags.grid) {\r\n      // add column\r\n      const cols = add_column(config.grid.getColumns(), 'weighted sum');\r\n      ps.gridUpdate({ columns: cols });\r\n    }\r\n\r\n    return this;\r\n  };\r\n\r\nexport default weightedSums;\r\n","import { isPlainObject, union } from 'lodash-es';\r\n\r\n/**\r\n * Hide a set of axes globally or from specific charts.\r\n *\r\n * @param partition: array or object idenifying axes to be hidden; if object, format as { chart id: [hidden vars]}\r\n */\r\nconst hideAxes = (config, ps, flags) =>\r\n  function(partition) {\r\n    if (Array.isArray(partition)) {\r\n      // append array to every key in config.partition\r\n      Object.keys(config.partition).forEach(function(id) {\r\n        config.partition[id] = union(config.partition[id], partition);\r\n      });\r\n    } else if (isPlainObject(partition)) {\r\n      // take union of values for each key that is also in config.partition\r\n      Object.entries(partition).forEach(([key, values]) => {\r\n        if (config.partition[key]) {\r\n          config.partition[key] = union(config.partition[key], partition[key]);\r\n        }\r\n      });\r\n    } else {\r\n      throw 'Error: please provide an object or array as argument.';\r\n    }\r\n\r\n    // iterate over partition keys and hide all variables in value array\r\n    Object.entries(config.partition).forEach(([chartID, vars]) => {\r\n      ps.charts[chartID].hideAxis(vars);\r\n      ps.charts[chartID].render().updateAxes(500);\r\n    });\r\n\r\n    return this;\r\n  };\r\n\r\nexport default hideAxes;\r\n","import { isPlainObject, difference } from 'lodash-es';\r\n\r\n/**\r\n * Show a set of axes globally or on specific charts\r\n *\r\n * @param partition: array or object idenifying axes to be shown; if object, format as { chart id: [vars to show]}\r\n */\r\nconst showAxes = (config, ps, flags) =>\r\n  function(partition) {\r\n    if (typeof partition === 'undefined') {\r\n      // show all axes on all charts (empty partition)\r\n      Object.keys(config.partition).forEach(function(id) {\r\n        config.partition[id] = [];\r\n      });\r\n    } else if (Array.isArray(partition)) {\r\n      // remove array from every key in config.partition\r\n      Object.keys(config.partition).forEach(function(id) {\r\n        config.partition[id] = difference(config.partition[id], partition);\r\n      });\r\n    } else if (isPlainObject(partition)) {\r\n      // take difference of values for each key that is also in config.partition\r\n      // (i.e. remove from hidden)\r\n      Object.entries(partition).forEach(([key, values]) => {\r\n        if (config.partition[key]) {\r\n          config.partition[key] = difference(\r\n            config.partition[key],\r\n            partition[key]\r\n          );\r\n        }\r\n      });\r\n    } else {\r\n      throw 'Error: please provide an object or array as argument.';\r\n    }\r\n\r\n    // iterate over partition keys and hide only remaining variables in value array\r\n    Object.entries(config.partition).forEach(([chartID, vars]) => {\r\n      ps.charts[chartID].hideAxis(vars);\r\n      ps.charts[chartID].render().updateAxes(500);\r\n    });\r\n\r\n    return this;\r\n  };\r\n\r\nexport default showAxes;\r\n","import { isPlainObject, difference } from 'lodash-es';\r\n\r\n/**\r\n * Specify the axes that will appear in each chart. Default for unspecified charts is to display all axes.\r\n *\r\n * @param {object} layout:  indentify a list of axes to be shown on each chart; format as { chart id: [vars to show]}\r\n */\r\nconst setAxesLayout = (config, ps, flags) =>\r\n  function(layout) {\r\n    if (isPlainObject(layout)) {\r\n      // take difference of all variables and layout variables\r\n      // i.e. show only those which appear in both data and layout\r\n      Object.entries(layout).forEach(([key, values]) => {\r\n        if (config.partition[key]) {\r\n          config.partition[key] = difference(\r\n            config.vars.concat('id'),\r\n            layout[key]\r\n          );\r\n        }\r\n      });\r\n    } else {\r\n      throw 'Error: please provide layout as a plain object.';\r\n    }\r\n\r\n    // iterate over partition keys and hide only remaining variables in value array\r\n    Object.entries(config.partition).forEach(([chartID, vars]) => {\r\n      ps.charts[chartID].hideAxis(vars);\r\n      ps.charts[chartID].render().updateAxes(0);\r\n    });\r\n\r\n    return this;\r\n  };\r\n\r\nexport default setAxesLayout;\r\n","/**\r\n * Keep only selected data update components\r\n *\r\n * @param data: One of {'brushed', 'marked', 'both'} keywords as string\r\n *\r\n * NOTE: Any existing brushes or marks will be overwritten\r\n */\r\nconst keepData = (config, ps, flags) =>\r\n  function(data) {\r\n    console.log('before:', config.data.length);\r\n\r\n    // identify data\r\n    let d = [];\r\n    if (data == 'brushed') {\r\n      d = config.brushed;\r\n    } else if (data == 'marked') {\r\n      d = config.marked;\r\n    } else if (data == 'both') {\r\n      d = config.selections();\r\n    } else {\r\n      throw \"Please specify one of {'brushed', 'marked', 'both'}\";\r\n    }\r\n    console.log(d);\r\n\r\n    if (d.length > 0) {\r\n      // reset selections and update config\r\n      ps.resetSelections('both');\r\n\r\n      // update data, charts, and grid\r\n      config.data = d;\r\n      ps.charts.forEach(pc => {\r\n        pc.data(d).render.default();\r\n        pc.brushReset();\r\n      });\r\n      if (flags.grid) {\r\n        ps.gridUpdate();\r\n      }\r\n    } else {\r\n      throw 'Error: No data selected.';\r\n    }\r\n\r\n    console.log('after:', config.data.length);\r\n    return this;\r\n  };\r\n\r\nexport default keepData;\r\n","import { difference } from 'lodash-es';\r\n\r\n/**\r\n * Remove selected data and components\r\n *\r\n * @param data: One of {'brushed', 'marked', 'both'} keywords as string\r\n *\r\n * NOTE: Any existing brushes or marks will be overwritten\r\n */\r\nconst removeData = (config, ps, flags) =>\r\n  function(data) {\r\n    console.log('before:', config.data.length);\r\n\r\n    // identify data\r\n    let d = [];\r\n    if (data == 'brushed') {\r\n      d = config.brushed;\r\n    } else if (data == 'marked') {\r\n      d = config.marked;\r\n    } else if (data == 'both') {\r\n      d = config.selections();\r\n    } else {\r\n      throw \"Please specify one of {'brushed', 'marked', 'both'}\";\r\n    }\r\n    d = difference(config.data, d);\r\n    console.log(d);\r\n\r\n    if (d.length > 0 && d.length < config.data.length) {\r\n      // reset selections and update config\r\n      ps.resetSelections('both');\r\n\r\n      // update data, charts, and grid\r\n      config.data = d;\r\n      ps.charts.forEach(pc => {\r\n        pc.data(d).render.default();\r\n        pc.brushReset();\r\n      });\r\n      if (flags.grid) {\r\n        ps.gridUpdate();\r\n      }\r\n    } else {\r\n      throw 'Error: No data selected.';\r\n    }\r\n\r\n    console.log('after:', config.data.length);\r\n    return this;\r\n  };\r\n\r\nexport default removeData;\r\n","/* FileSaver.js\n * A saveAs() FileSaver implementation.\n * 1.3.2\n * 2016-06-16 18:25:19\n *\n * By Eli Grey, http://eligrey.com\n * License: MIT\n *   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md\n */\n\n/*global self */\n/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */\n\n/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */\n\nvar saveAs = saveAs || (function(view) {\n\t\"use strict\";\n\t// IE <10 is explicitly unsupported\n\tif (typeof view === \"undefined\" || typeof navigator !== \"undefined\" && /MSIE [1-9]\\./.test(navigator.userAgent)) {\n\t\treturn;\n\t}\n\tvar\n\t\t  doc = view.document\n\t\t  // only get URL when necessary in case Blob.js hasn't overridden it yet\n\t\t, get_URL = function() {\n\t\t\treturn view.URL || view.webkitURL || view;\n\t\t}\n\t\t, save_link = doc.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\")\n\t\t, can_use_save_link = \"download\" in save_link\n\t\t, click = function(node) {\n\t\t\tvar event = new MouseEvent(\"click\");\n\t\t\tnode.dispatchEvent(event);\n\t\t}\n\t\t, is_safari = /constructor/i.test(view.HTMLElement) || view.safari\n\t\t, is_chrome_ios =/CriOS\\/[\\d]+/.test(navigator.userAgent)\n\t\t, throw_outside = function(ex) {\n\t\t\t(view.setImmediate || view.setTimeout)(function() {\n\t\t\t\tthrow ex;\n\t\t\t}, 0);\n\t\t}\n\t\t, force_saveable_type = \"application/octet-stream\"\n\t\t// the Blob API is fundamentally broken as there is no \"downloadfinished\" event to subscribe to\n\t\t, arbitrary_revoke_timeout = 1000 * 40 // in ms\n\t\t, revoke = function(file) {\n\t\t\tvar revoker = function() {\n\t\t\t\tif (typeof file === \"string\") { // file is an object URL\n\t\t\t\t\tget_URL().revokeObjectURL(file);\n\t\t\t\t} else { // file is a File\n\t\t\t\t\tfile.remove();\n\t\t\t\t}\n\t\t\t};\n\t\t\tsetTimeout(revoker, arbitrary_revoke_timeout);\n\t\t}\n\t\t, dispatch = function(filesaver, event_types, event) {\n\t\t\tevent_types = [].concat(event_types);\n\t\t\tvar i = event_types.length;\n\t\t\twhile (i--) {\n\t\t\t\tvar listener = filesaver[\"on\" + event_types[i]];\n\t\t\t\tif (typeof listener === \"function\") {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlistener.call(filesaver, event || filesaver);\n\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\tthrow_outside(ex);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t, auto_bom = function(blob) {\n\t\t\t// prepend BOM for UTF-8 XML and text/* types (including HTML)\n\t\t\t// note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n\t\t\tif (/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n\t\t\t\treturn new Blob([String.fromCharCode(0xFEFF), blob], {type: blob.type});\n\t\t\t}\n\t\t\treturn blob;\n\t\t}\n\t\t, FileSaver = function(blob, name, no_auto_bom) {\n\t\t\tif (!no_auto_bom) {\n\t\t\t\tblob = auto_bom(blob);\n\t\t\t}\n\t\t\t// First try a.download, then web filesystem, then object URLs\n\t\t\tvar\n\t\t\t\t  filesaver = this\n\t\t\t\t, type = blob.type\n\t\t\t\t, force = type === force_saveable_type\n\t\t\t\t, object_url\n\t\t\t\t, dispatch_all = function() {\n\t\t\t\t\tdispatch(filesaver, \"writestart progress write writeend\".split(\" \"));\n\t\t\t\t}\n\t\t\t\t// on any filesys errors revert to saving with object URLs\n\t\t\t\t, fs_error = function() {\n\t\t\t\t\tif ((is_chrome_ios || (force && is_safari)) && view.FileReader) {\n\t\t\t\t\t\t// Safari doesn't allow downloading of blob urls\n\t\t\t\t\t\tvar reader = new FileReader();\n\t\t\t\t\t\treader.onloadend = function() {\n\t\t\t\t\t\t\tvar url = is_chrome_ios ? reader.result : reader.result.replace(/^data:[^;]*;/, 'data:attachment/file;');\n\t\t\t\t\t\t\tvar popup = view.open(url, '_blank');\n\t\t\t\t\t\t\tif(!popup) view.location.href = url;\n\t\t\t\t\t\t\turl=undefined; // release reference before dispatching\n\t\t\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\t\t\tdispatch_all();\n\t\t\t\t\t\t};\n\t\t\t\t\t\treader.readAsDataURL(blob);\n\t\t\t\t\t\tfilesaver.readyState = filesaver.INIT;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// don't create more object URLs than needed\n\t\t\t\t\tif (!object_url) {\n\t\t\t\t\t\tobject_url = get_URL().createObjectURL(blob);\n\t\t\t\t\t}\n\t\t\t\t\tif (force) {\n\t\t\t\t\t\tview.location.href = object_url;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar opened = view.open(object_url, \"_blank\");\n\t\t\t\t\t\tif (!opened) {\n\t\t\t\t\t\t\t// Apple does not allow window.open, see https://developer.apple.com/library/safari/documentation/Tools/Conceptual/SafariExtensionGuide/WorkingwithWindowsandTabs/WorkingwithWindowsandTabs.html\n\t\t\t\t\t\t\tview.location.href = object_url;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\tdispatch_all();\n\t\t\t\t\trevoke(object_url);\n\t\t\t\t}\n\t\t\t;\n\t\t\tfilesaver.readyState = filesaver.INIT;\n\n\t\t\tif (can_use_save_link) {\n\t\t\t\tobject_url = get_URL().createObjectURL(blob);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tsave_link.href = object_url;\n\t\t\t\t\tsave_link.download = name;\n\t\t\t\t\tclick(save_link);\n\t\t\t\t\tdispatch_all();\n\t\t\t\t\trevoke(object_url);\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfs_error();\n\t\t}\n\t\t, FS_proto = FileSaver.prototype\n\t\t, saveAs = function(blob, name, no_auto_bom) {\n\t\t\treturn new FileSaver(blob, name || blob.name || \"download\", no_auto_bom);\n\t\t}\n\t;\n\t// IE 10+ (native saveAs)\n\tif (typeof navigator !== \"undefined\" && navigator.msSaveOrOpenBlob) {\n\t\treturn function(blob, name, no_auto_bom) {\n\t\t\tname = name || blob.name || \"download\";\n\n\t\t\tif (!no_auto_bom) {\n\t\t\t\tblob = auto_bom(blob);\n\t\t\t}\n\t\t\treturn navigator.msSaveOrOpenBlob(blob, name);\n\t\t};\n\t}\n\n\tFS_proto.abort = function(){};\n\tFS_proto.readyState = FS_proto.INIT = 0;\n\tFS_proto.WRITING = 1;\n\tFS_proto.DONE = 2;\n\n\tFS_proto.error =\n\tFS_proto.onwritestart =\n\tFS_proto.onprogress =\n\tFS_proto.onwrite =\n\tFS_proto.onabort =\n\tFS_proto.onerror =\n\tFS_proto.onwriteend =\n\t\tnull;\n\n\treturn saveAs;\n}(\n\t   typeof self !== \"undefined\" && self\n\t|| typeof window !== \"undefined\" && window\n\t|| this.content\n));\n// `self` is undefined in Firefox for Android content script context\n// while `this` is nsIContentFrameMessageManager\n// with an attribute `content` that corresponds to the window\n\nif (typeof module !== \"undefined\" && module.exports) {\n  module.exports.saveAs = saveAs;\n} else if ((typeof define !== \"undefined\" && define !== null) && (define.amd !== null)) {\n  define(\"FileSaver.js\", function() {\n    return saveAs;\n  });\n}\n","import { csvFormat } from 'd3';\r\nimport { saveAs } from 'file-saver/FileSaver';\r\n\r\n/**\r\n * Export selected data to new csv and download\r\n *\r\n * @param {string} selection: one of {'brushed', 'marked', 'both'}\r\n * @param {string} filename:  name of csv file to be downloaded\r\n * @param {boolean} exportAll:  override selection param and export all data\r\n */\r\nconst exportData = (config, ps, flags) =>\r\n  function({ selection = 'both', filename = null, exportAll = false }) {\r\n    if (filename === null) {\r\n      filename = 'parasol_data.csv';\r\n    }\r\n\r\n    // identify data\r\n    let d = [];\r\n    if (exportAll) {\r\n      d = config.data;\r\n    } else if (selection == 'brushed') {\r\n      d = config.brushed;\r\n    } else if (selection == 'marked') {\r\n      d = config.marked;\r\n    } else if (selection == 'both') {\r\n      d = config.selections();\r\n    } else {\r\n      throw \"Please specify one of {'brushed', 'marked', 'both'}\";\r\n    }\r\n\r\n    if (d.length > 0) {\r\n      // format data as csv\r\n      // NOTE: include assigned data id number?\r\n      const csv = csvFormat(d, config.vars);\r\n\r\n      // create url and download\r\n      const file = new Blob([csv], { type: 'text/csv' });\r\n      saveAs(file, filename);\r\n    } else {\r\n      throw 'Error: No data selected.';\r\n    }\r\n    return this;\r\n  };\r\n\r\nexport default exportData;\r\n","/**\r\n * Selections are the collection of all brushed and marked data; reset all or just a subset (brushed or marked)\r\n *\r\n * @param {string} selection: One of {'brushed', 'marked', 'both'} keywords as string\r\n *\r\n * NOTE: if linked charts exist, only those are affected\r\n */\r\nconst resetSelections = (config, ps, flags) => selection => {\r\n  if (selection == 'brushed') {\r\n    ps.brushReset();\r\n  } else if (selection == 'marked') {\r\n    ps.unmark();\r\n  } else if (selection == 'both') {\r\n    ps.brushReset();\r\n    ps.unmark();\r\n  } else {\r\n    throw \"Please specify one of {'brushed', 'marked', 'both'}\";\r\n  }\r\n};\r\n\r\nexport default resetSelections;\r\n","// parcoords wrapper: set foreground alpha on all charts\r\nconst alpha = (config, ps, flags) =>\r\n  function(d) {\r\n    ps.charts.forEach(pc => pc.alpha(d));\r\n    return this;\r\n  };\r\nexport default alpha;\r\n","// parcoords wrapper: set polyline hex color on all charts\r\nconst color = (config, ps, flags) =>\r\n  function(d) {\r\n    ps.charts.forEach(pc => pc.color(d));\r\n    return this;\r\n  };\r\nexport default color;\r\n","// parcoords wrapper: set foreground alpha when brushes exist\r\nconst alphaOnBrushed = (config, ps, flags) =>\r\n  function(d) {\r\n    ps.charts.forEach(pc => pc.alphaOnBrushed(d));\r\n    return this;\r\n  };\r\nexport default alphaOnBrushed;\r\n","// parcoords wrapper: set hex color of polylines within brush extents\r\nconst brushedColor = (config, ps, flags) =>\r\n  function(d) {\r\n    ps.charts.forEach(pc => pc.brushedColor(d));\r\n    return this;\r\n  };\r\nexport default brushedColor;\r\n","// parcoords wrapper: enable reordering on all charts\r\n\r\n// const reorderable = (config, ps, flags) =>\r\n//   function({ chartIDs=[...Array(ps.charts.length).keys()] }={}) {\r\n//     ps.charts.forEach( (pc, i) => {\r\n//       if (chartIDs.includes(i)) {\r\n//         pc\r\n//           .reorderable()\r\n//           .hideAxis(config.partition[i])\r\n//           .render()\r\n//           .updateAxes(0);\r\n//       }\r\n//     });\r\n//     return this;\r\n//   }\r\n// export default reorderable;\r\n\r\nconst reorderable = (config, ps, flags) =>\r\n  function() {\r\n    ps.charts.forEach(pc => pc.reorderable());\r\n    return this;\r\n  };\r\nexport default reorderable;\r\n","// parcoords wrapper: set composite mode on all charts\r\nconst composite = (config, ps, flags) =>\r\n  function(d) {\r\n    ps.charts.forEach(pc => pc.composite(d));\r\n    return this;\r\n  };\r\nexport default composite;\r\n","// parcoords wrapper: enable shadows on all charts\r\nconst shadows = (config, ps, flags) =>\r\n  function(d) {\r\n    ps.charts.forEach(pc => pc.shadows(d));\r\n    return this;\r\n  };\r\nexport default shadows;\r\n","// parcoords wrapper: format dimensions (applies to all charts)\r\nconst dimensions = (config, ps, flags) =>\r\n  function(d) {\r\n    ps.charts.forEach(pc => pc.dimensions(d));\r\n    return this;\r\n  };\r\nexport default dimensions;\r\n","// parcoords wrapper: flip listed axes on all charts\r\nconst flipAxes = (config, ps, flags) =>\r\n  function(axes) {\r\n    ps.charts.forEach(pc => pc.flipAxes(axes));\r\n    return this;\r\n  };\r\nexport default flipAxes;\r\n","// parcoords wrapper: set the domain (and scale?) of a single axis on all charts\r\nconst scale = (config, ps, flags) =>\r\n  function(axis, domain) {\r\n    const range = ps.charts[0].dimensions()[axis].yscale.domain();\r\n    if (range[0] >= domain[0] && range[1] <= domain[1]) {\r\n      ps.charts.forEach(pc => pc.scale(axis, domain));\r\n    } else {\r\n      throw Error(\r\n        'Domain Error: specified domain must be exceed axis extrema.'\r\n      );\r\n    }\r\n    return this;\r\n  };\r\nexport default scale;\r\n","// parcoords wrapper: set bundle dimension on all charts\r\nconst bundleDimension = (config, ps, flags) =>\r\n  function(d) {\r\n    ps.charts.forEach(pc => pc.bundleDimension(d));\r\n    return this;\r\n  };\r\nexport default bundleDimension;\r\n","// parcoords wrapper: set bundling strength on all charts\r\nconst bundlingStrength = (config, ps, flags) =>\r\n  function(d) {\r\n    ps.charts.forEach(pc => pc.bundlingStrength(d));\r\n    return this;\r\n  };\r\nexport default bundlingStrength;\r\n","// parcoords wrapper: set bundling smoothness on all charts\r\nconst smoothness = (config, ps, flags) =>\r\n  function(d) {\r\n    ps.charts.forEach(pc => pc.smoothness(d));\r\n    return this;\r\n  };\r\nexport default smoothness;\r\n","// parcoords wrapper: render and update charts, maintain config\r\nconst render = (config, ps, flags) =>\r\n  function() {\r\n    ps.charts.forEach((pc, i) => {\r\n      pc.hideAxis(config.partition[i])\r\n        .render()\r\n        .updateAxes(0);\r\n    });\r\n    return this;\r\n  };\r\nexport default render;\r\n","// parcoords wrapper: reset all brushes and preform necessary updates\r\nconst brushReset = (config, ps, flags) => () => {\r\n  ps.charts.forEach(pc => pc.brushReset());\r\n\r\n  // NOTE: if charts are linked and at least one is not reset, then none will be reset\r\n\r\n  // NOTE: brushed data in config is updated by sync() as consequence of pc.brushReset()\r\n  // currently need to force due to issue with ParCoords.selected() returning entire dataset if brush extents are empty\r\n  config.brushed = [];\r\n\r\n  if (flags.grid) {\r\n    ps.gridUpdate();\r\n  }\r\n};\r\n\r\nexport default brushReset;\r\n","// parcoords wrapper: reset all marks and preform necessary updates\r\nconst unmark = (config, ps, flags) => () => {\r\n  ps.charts.forEach(pc => pc.unmark());\r\n  config.marked = [];\r\n  if (flags.grid) {\r\n    config.grid.setSelectedRows([]);\r\n    ps.gridUpdate();\r\n  }\r\n};\r\n\r\nexport default unmark;\r\n","// parcoords wrapper: reset all highlights\r\nconst unhighlight = (config, ps, flags) => () => {\r\n  ps.charts.forEach(pc => pc.unhighlight());\r\n};\r\nexport default unhighlight;\r\n","import { union } from 'lodash-es';\r\n\r\nconst DefaultConfig = {\r\n  dataView: false,\r\n  grid: false,\r\n  chartOptions: {}, // parcoords options, applies to all charts\r\n  brushed: [], // intersection of all brushed data in linked charts\r\n  marked: [], // union of all marked data in linked charts\r\n  selections: function() {\r\n    return union(this.brushed, this.marked);\r\n  },\r\n};\r\n\r\nexport default DefaultConfig;\r\n","import { entries, keys, dispatch } from 'd3';\r\n\r\nimport DefaultConfig from './defaultConfig';\r\nimport format_data from '../util/format_data';\r\n\r\nconst initState = (data, userConfig) => {\r\n  const config = Object.assign({}, DefaultConfig, userConfig);\r\n  // force attributes for consistent operation\r\n  config.data = data;\r\n  config.vars = Object.keys(data[0]); // does not contain 'id'\r\n  config.partition = {}; // { chart id: [hidden vars]} built in init.js\r\n\r\n  // assign each data element an ID for slickgrid and other analyses\r\n  config.data.forEach((d, i) => {\r\n    d.id = d.id || i;\r\n  });\r\n  config.data = format_data(config.data);\r\n\r\n  // NOTE: \"id\" col hidden globally by default in init.js\r\n\r\n  const eventTypes = [\r\n    // 'data', // when data in a chart is updated, how should this cascade to linked?\r\n    // 'render',\r\n    // 'resize',\r\n    // 'highlight',\r\n    // 'mark',\r\n    'brush',\r\n    'brushend',\r\n    'brushstart',\r\n    // 'axesreorder',\r\n  ].concat(keys(config));\r\n\r\n  const events = dispatch.apply(this, eventTypes),\r\n    flags = {\r\n      linked: false,\r\n      grid: false,\r\n      // axes: false,\r\n      // interactive: false,\r\n      // debug: false,\r\n    };\r\n  // xscale = scalePoint(),\r\n  // dragging = {},\r\n  // axis = axisLeft().ticks(5),\r\n  // ctx = {},\r\n  // canvas = {};\r\n\r\n  return {\r\n    config,\r\n    events,\r\n    eventTypes,\r\n    flags,\r\n  };\r\n};\r\n\r\nexport default initState;\r\n","//css\r\nimport './parallel-coordinates.css';\r\n\r\n//misc\r\n\r\n//api\r\nimport init from './api/init';\r\nimport attachGrid from './api/attachGrid';\r\nimport gridUpdate from './api/gridUpdate';\r\nimport linked from './api/linked';\r\nimport cluster from './api/cluster';\r\nimport weightedSums from './api/weightedSums';\r\nimport hideAxes from './api/hideAxes';\r\nimport showAxes from './api/showAxes';\r\nimport setAxesLayout from './api/setAxesLayout';\r\nimport keepData from './api/keepData';\r\nimport removeData from './api/removeData';\r\nimport exportData from './api/exportData';\r\nimport resetSelections from './api/resetSelections';\r\n\r\n// parcoords wrappers\r\nimport alpha from './wrap/alpha';\r\nimport color from './wrap/color';\r\nimport alphaOnBrushed from './wrap/alphaOnBrushed';\r\nimport brushedColor from './wrap/brushedColor';\r\nimport reorderable from './wrap/reorderable';\r\nimport composite from './wrap/composite';\r\nimport shadows from './wrap/shadows';\r\n// import mark from './wrap/mark';\r\n// import highlight from './wrap/highlight';\r\nimport dimensions from './wrap/dimensions';\r\nimport flipAxes from './wrap/flipAxes';\r\nimport scale from './wrap/scale';\r\nimport bundleDimension from './wrap/bundleDimension';\r\nimport bundlingStrength from './wrap/bundlingStrength';\r\nimport smoothness from './wrap/smoothness';\r\nimport render from './wrap/render';\r\nimport brushReset from './wrap/brushReset';\r\nimport unmark from './wrap/unmark';\r\nimport unhighlight from './wrap/unhighlight';\r\n\r\nimport initState from './state/initState';\r\n// import bindEvents from './bindEvents';\r\nimport { version } from '../package.json';\r\n\r\nconst Parasol = (data, userConfig) => {\r\n  const state = initState(data, userConfig);\r\n  const { config, events, flags } = state;\r\n\r\n  const ps = init(config);\r\n\r\n  // bindEvents();\r\n\r\n  // expose the state of charts and grid\r\n  ps.state = config;\r\n  ps.flags = flags;\r\n  ps.version = version;\r\n  ps.grid = config.grid;\r\n  ps.dataview = config.dataview;\r\n\r\n  ps.attachGrid = attachGrid(config, ps, flags);\r\n  ps.gridUpdate = gridUpdate(config, ps, flags);\r\n  ps.linked = linked(config, ps, flags);\r\n  ps.cluster = cluster(config, ps, flags);\r\n  ps.weightedSums = weightedSums(config, ps, flags);\r\n  ps.hideAxes = hideAxes(config, ps, flags);\r\n  ps.showAxes = showAxes(config, ps, flags);\r\n  ps.setAxesLayout = setAxesLayout(config, ps, flags);\r\n  ps.keepData = keepData(config, ps, flags);\r\n  ps.removeData = removeData(config, ps, flags);\r\n  ps.exportData = exportData(config, ps, flags);\r\n  ps.resetSelections = resetSelections(config, ps, flags);\r\n\r\n  // parcoords methods (global)\r\n  ps.alpha = alpha(config, ps, flags);\r\n  ps.color = color(config, ps, flags);\r\n  ps.alphaOnBrushed = alphaOnBrushed(config, ps, flags);\r\n  ps.brushedColor = brushedColor(config, ps, flags);\r\n  ps.reorderable = reorderable(config, ps, flags);\r\n  ps.composite = composite(config, ps, flags);\r\n  ps.shadows = shadows(config, ps, flags);\r\n  // ps.mark = mark(config, ps, flags);\r\n  // ps.highlight = highlight(config, ps, flags);\r\n  ps.dimensions = dimensions(config, ps, flags);\r\n  ps.scale = scale(config, ps, flags);\r\n  ps.flipAxes = flipAxes(config, ps, flags);\r\n  ps.bundleDimension = bundleDimension(config, ps, flags);\r\n  ps.bundlingStrength = bundlingStrength(config, ps, flags);\r\n  ps.smoothness = smoothness(config, ps, flags);\r\n  ps.render = render(config, ps, flags);\r\n  ps.brushReset = brushReset(config, ps, flags);\r\n  ps.unmark = unmark(config, ps, flags);\r\n  ps.unhighlight = unhighlight(config, ps, flags);\r\n\r\n  return ps;\r\n};\r\n\r\nexport default Parasol;\r\n"],"names":["init","ps","selection","selectAll","charts","each","d","i","ParCoords","config","chartOptions","data","hideAxis","alpha","render","mode","brushMode","partition","as_float","converted","parseFloat","x","isNaN","attachGrid","flags","container","columns","options","grid","checkboxSelector","SlickGrid","Plugins","CheckboxSelectColumn","column_keys","vars","difference","unshift","map","key","getColumnDefinition","dataView","Data","DataView","setItems","Grid","setSelectionModel","RowSelectionModel","selectActiveRow","registerPlugin","onRowCountChanged","subscribe","e","args","updateRowCount","onRowsChanged","invalidateRows","rows","syncGridSelection","sortcol","c","name","shift","sortdir","comparer","a","b","y","onSort","sortAsc","sortCol","field","sort","gridUpdate","setColumns","selections","length","marked","union","beginUpdate","endUpdate","sync","brush_extents","linked","forEach","push","pc","selected","brushReset","brushed","intersection","chartIDs","Array","keys","Number","j","on","onMouseEnter","getCellFromEvent","row","getItems","highlight","onMouseLeave","unhighlight","onSelectedRowsChanged","selected_row_ids","getSelectedRows","unmark","mark","array_to_object","reduce","acc","obj","k","concat","object_to_array","df","result","entries","values","val","toString","arr","array","Math","max","apply","min","num","l","sum","mean","pow","sqrt","variance","standardDeviation","extents","standardize","zScores","format_data","csvParse","csvFormat","add_column","col_name","names","col","includes","col_def","cluster","displayIDs","palette","schemeCategory10","std","hidden","isArray","scheme","scaleOrdinal","cluster_vars","v","target","value","kmeans","clusters","id","createAxes","color","updateAxes","cols","getColumns","normalize","norms","weightedSums","weights","norm","row_totals","d_weight","score","log","hideAxes","isPlainObject","chartID","showAxes","setAxesLayout","layout","keepData","resetSelections","default","removeData","saveAs","view","navigator","test","userAgent","doc","document","get_URL","URL","webkitURL","save_link","createElementNS","can_use_save_link","click","node","event","MouseEvent","dispatchEvent","is_safari","HTMLElement","safari","is_chrome_ios","throw_outside","ex","setImmediate","setTimeout","force_saveable_type","arbitrary_revoke_timeout","revoke","file","revoker","revokeObjectURL","remove","dispatch","filesaver","event_types","listener","call","auto_bom","blob","type","Blob","String","fromCharCode","FileSaver","no_auto_bom","force","object_url","dispatch_all","split","fs_error","FileReader","reader","onloadend","url","replace","popup","open","location","href","undefined","readyState","DONE","readAsDataURL","INIT","createObjectURL","opened","download","FS_proto","prototype","msSaveOrOpenBlob","abort","WRITING","error","onwritestart","onprogress","onwrite","onabort","onerror","onwriteend","self","window","this","content","module","exports","exportData","filename","exportAll","csv","alphaOnBrushed","brushedColor","reorderable","composite","shadows","dimensions","flipAxes","axes","scale","axis","domain","range","yscale","Error","bundleDimension","bundlingStrength","smoothness","setSelectedRows","DefaultConfig","initState","userConfig","Object","assign","eventTypes","events","Parasol","state","version","dataview"],"mappings":"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"}